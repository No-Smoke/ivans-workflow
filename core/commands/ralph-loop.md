# Generated by Ivan's Workflow — https://github.com/No-Smoke/ivans-workflow

# /ralph-loop — Auto-retry quality checks with fixes

Named after "Ralph Wrecks the Tests." Runs all quality checks in a loop, automatically fixing failures until everything passes or the retry limit is hit.

## Steps

1. Read quality commands from `.claude/project-config.yaml`
2. Enter retry loop (max 50 iterations):

   ```
   ═══ Ralph Loop — Iteration {N}/50 ═══
   [1/3] Typecheck... ✗ FAILED
   → Fixing 3 type errors in src/calculator.ts...
   [1/3] Typecheck... ✓ PASSED
   [2/3] Lint... ✓ PASSED
   [3/3] Tests... ✗ 2 FAILED
   → Fixing test expectations in tests/calculator.test.ts...
   [3/3] Tests... ✓ PASSED
   ═══ All checks pass! Iteration 3 ═══
   ```

3. For each failure:
   - Parse error output to identify the issue
   - Apply the fix
   - Re-run that specific check before proceeding

4. Stop conditions:
   - ✓ All checks pass → print success, offer to commit
   - ✗ Same error repeated 10 times → abort with "Stuck on: {error}"
   - ✗ 50 iterations reached → abort with summary of remaining failures
   - ✗ Fix attempt makes things worse (more failures than before) → rollback fix, abort

## Safety Limits

- Maximum 50 iterations total
- Maximum 10 retries for the same error signature
- Track failure count: if it increases after a fix, rollback with `git checkout -- {file}`
- Never modify files outside `{config:paths.source}` and `{config:paths.tests}`
- Never touch schema files, config files, or deployment files

## Output

On completion, print:
- Total iterations used
- Files modified during the loop
- Final quality gate status
- Offer: "Run /test-and-commit to commit these fixes?"
