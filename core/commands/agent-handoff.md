# Generated by Ivan's Workflow — https://github.com/No-Smoke/ivans-workflow

# /agent-handoff — Generate structured handoff for next agent

Generate a structured JSON handoff file for the next agent in the pipeline. Determines the current agent role from context, gathers deliverables, and writes to the handoff directory.

## Steps

1. Determine current agent role (from `IVAN_AGENT_ROLE` env var or infer from context)
2. Determine the current task ID (from recent handoff files or ask)
3. Determine next agent in pipeline:
   - planner → builder
   - builder → reviewer
   - reviewer → tester (or → builder if revision needed)
   - tester → deployer (or → builder if failures found)
   - deployer → docs
4. Gather deliverables:
   - `git diff --stat` for files changed
   - Recent test output (if available)
   - Key decisions made during this phase
5. Write full JSON handoff to: `{config:paths.handoffs}/{TASK-ID}/{seq}-{from}-to-{next}.json`
6. Print 5-line quick handoff to terminal

## Handoff Format

Uses the standard schema from the `workflow-handoff` skill. See that skill for the full JSON schema and quick format.

## Sequence Number

Read existing handoff files in the task directory, find the highest sequence number, increment by 1.

## Revision Handoffs

If the current agent is sending work BACK (e.g., Reviewer → Builder for fixes):
- Set `status: "revision_requested"`
- Include specific issues to fix in `for_next_agent.focus_areas`
- Reference the original handoff being revised
